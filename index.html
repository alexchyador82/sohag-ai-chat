<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SohagGPT</title>
</head>
<body>
  <h1>ğŸ¤– SohagGPT</h1>

  <input type="password" id="apiKeyInput" placeholder="ğŸ”‘ OpenAI API Key à¦¦à¦¿à¦¨">
  <button onclick="saveKey()">âœ… Save API Key</button>
  <br><br>

  <input id="userInput" placeholder="âœï¸ à¦ªà§à¦°à¦¶à§à¦¨ à¦²à¦¿à¦–à§à¦¨ à¦¬à¦¾ ğŸ¤ à¦¬à¦²à§à¦¨..." />
  <button onclick="sendMessage()">ğŸ“¤ à¦ªà¦¾à¦ à¦¾à¦“</button>
  <button onclick="startListening()">ğŸ¤ à¦¬à¦²à§à¦¨</button>
  <p id="responseText"></p>

  <script>
    function saveKey() {
      const key = document.getElementById("apiKeyInput").value;
      localStorage.setItem("openai_api_key", key);
      alert("âœ… API Key à¦¬à§à¦°à¦¾à¦‰à¦œà¦¾à¦°à§‡ à¦¸à§‡à¦­ à¦¹à§Ÿà§‡à¦›à§‡!");
    }

    async function sendMessage() {
      const apiKey = localStorage.getItem("openai_api_key");
      if (!apiKey) return alert("âš ï¸ API Key à¦¨à§‡à¦‡! à¦†à¦—à§‡ à¦¸à§‡à¦Ÿ à¦•à¦°à§à¦¨à¥¤");

      const prompt = document.getElementById("userInput").value;
      const res = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": "Bearer " + apiKey
        },
        body: JSON.stringify({
          model: "gpt-3.5-turbo",
          messages: [{ role: "user", content: prompt }]
        })
      });

      const data = await res.json();
      const reply = data.choices?.[0]?.message?.content || "âŒ à¦‰à¦¤à§à¦¤à¦° à¦ªà¦¾à¦“à§Ÿà¦¾ à¦¯à¦¾à§Ÿà¦¨à¦¿!";
      document.getElementById("responseText").innerText = reply;
      speak(reply);
    }

    function speak(text) {
      const speech = new SpeechSynthesisUtterance(text);
      speech.lang = "bn-BD";
      speechSynthesis.speak(speech);
    }

    function startListening() {
      const recognition = new webkitSpeechRecognition();
      recognition.lang = "bn-BD";
      recognition.onresult = (event) => {
        const speechText = event.results[0][0].transcript;
        document.getElementById("userInput").value = speechText;
        sendMessage();
      };
      recognition.start();
    }
  </script>
</body>
</html>
